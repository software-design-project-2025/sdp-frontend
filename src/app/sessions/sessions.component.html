<!-- Sessions Page Header -->
<header class="sessions-header">
  <h1>Study Sessions</h1>
  <button class="create-btn" (click)="createSession()">➕ Create Session</button>
</header>

<!-- Upcoming Sessions Section -->
<section class="sessions-container">
  <h2 class="section-title">Upcoming Sessions</h2>

  <div *ngIf="sessions.length === 0" style="padding: 2rem; text-align: center; color: #666;">
    No upcoming sessions. Create one to get started!
  </div>

  <!-- Session Cards -->
  <article class="session-card" *ngFor="let session of sessions">
    <header class="session-header">
      <div class="session-title-section">
        <h3 class="session-title">{{ session.title }}</h3>
        <ul class="session-badges">
          <li class="badge"
              [class.confirmed]="session.status === 'confirmed'"
              [class.open]="session.status === 'open'">
            {{ session.status === 'confirmed' ? '✅ Confirmed' : '🟢 Open' }}
          </li>
          <li class="badge type-badge"
              [class.in-person]="session.type === 'in-person'"
              [class.online]="session.type === 'online'">
            {{ session.type === 'in-person' ? '🏫 In-Person' : '🌐 Online' }}
          </li>
        </ul>
      </div>

      <nav class="session-actions">
        <button *ngIf="session.type === 'in-person'"
                class="action-btn directions-btn"
                (click)="getDirections(session)">
          📍 Get Directions
        </button>

        <button *ngIf="session.type === 'online'"
                class="action-btn join-online-btn"
                (click)="joinOnline(session)">
          🎥 Join Online
        </button>

        <button class="action-btn view-details-btn" (click)="viewDetails(session)">
          🔎 View Details
        </button>
      </nav>
    </header>

    <section class="session-details">
      <ul class="session-info">
        <li class="info-item">📅 {{ session.date }}</li>
        <li class="info-item">⏰ {{ session.time }}</li>
        <li class="info-item" *ngIf="session.location || session.url">
          📍 {{ session.type === 'in-person' ? session.location : (session.url || 'Online') }}
        </li>
      </ul>

      <footer class="session-meta">
        <p class="participants-info">👥 {{ session.participantCount }}/{{ session.maxParticipants }} participants</p>
        <p class="organizer-info">🧑‍🏫 Organized by {{ session.organizer }}</p>
      </footer>
    </section>

    <section class="session-topics" *ngIf="session.topics && session.topics.length > 0">
      <ul>
        <li class="topic-tag" *ngFor="let topic of session.topics">#{{ topic }}</li>
      </ul>
    </section>

    <section *ngIf="session.description" style="margin-top: 0.8rem; color: #555; font-size: 0.9rem;">
      {{ session.description }}
    </section>
  </article>
</section>

<!-- Past Sessions Section -->
<section class="sessions-container past-events">
  <h2 class="section-title">Past Sessions</h2>

  <article class="session-card" *ngFor="let past of pastSessions">
    <header class="session-header">
      <div class="session-title-section">
        <h3 class="session-title">{{ past.title }}</h3>
      </div>
      <nav class="session-actions">
        <button class="action-btn summary-btn" (click)="viewSummary(past)">📄 View Summary</button>
        <button class="action-btn reschedule-btn" (click)="scheduleAgain(past)">🔄 Reschedule</button>
      </nav>
    </header>

    <section class="session-details">
      <ul class="session-info">
        <li class="info-item">📅 {{ past.date }}</li>
        <li class="info-item">⏰ {{ past.time }}</li>
        <li class="info-item">👥 {{ past.participantCount }} attendees</li>
        <li class="info-item">⭐ {{ past.rating }}/5</li>
      </ul>
    </section>
  </article>
</section>

<!-- Create Session Modal -->
<div class="modal-backdrop" *ngIf="showModal">
  <div class="modal">
    <h2>Create New Session</h2>

    <label>
      Session Title: <span style="color: red;">*</span>
      <input type="text" [(ngModel)]="newSession.title" placeholder="e.g., Calculus Study Group" required />
    </label>

    <label>
      Group: <span style="color: red;">*</span>
      <select [(ngModel)]="newSession.groupid" required>
        <option [value]="0" disabled>Select a group</option>
        <option *ngFor="let group of groups" [value]="group.groupid">
          {{ group.title }}
        </option>
      </select>
    </label>

    <label>
      Start Date & Time: <span style="color: red;">*</span>
      <input type="datetime-local" [(ngModel)]="newSession.start_time" required />
    </label>

    <label>
      End Date & Time: (Optional)
      <input type="datetime-local" [(ngModel)]="newSession.end_time" />
    </label>

    <label>
      Status:
      <select [(ngModel)]="newSession.status">
        <option value="open">Open</option>
        <option value="confirmed">Confirmed</option>
        <option value="cancelled">Cancelled</option>
      </select>
    </label>

    <label>
      Location/URL: (Optional)
      <input type="text" [(ngModel)]="newSession.location"
             placeholder="e.g., Library Room 305 or https://meet.google.com/..." />
      <small style="color: #666; font-size: 0.8rem;">
        Enter a physical location or online meeting URL
      </small>
    </label>

    <label>
      Description: (Optional)
      <textarea [(ngModel)]="newSession.description"
                rows="3"
                placeholder="Add session details, topics to cover, etc."
                style="padding: 0.5rem; border-radius: 8px; border: 1px solid #ccc; font-size: 0.9rem; font-family: inherit; resize: vertical;">
      </textarea>
    </label>

    <div class="modal-actions">
      <button class="confirm-btn" (click)="confirmSession()">Create Session</button>
      <button class="cancel-btn" (click)="cancelSession()">Cancel</button>
    </div>
  </div>
</div>
